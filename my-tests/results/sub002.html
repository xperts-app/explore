<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Student Dashboard</title>
  <style>
    body { font-family: Arial, sans-serif; margin:0; padding:20px; background:#f0f2f5; }
    h1 { margin-top:0; }
    .logout-btn {
      padding: 10px 16px;
      background: #e33;
      color: #fff;
      border: none;
      border-radius: 6px;
      cursor: pointer;
    }
  </style>
</head>
<body>

  <h1>Welcome Student</h1>
  <button class="logout-btn" onclick="logout()">Logout</button>

  <div id="content">
    <p>Loading your data...</p>
  </div>

  <!-- Firebase -->
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js"></script>

  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyD-ers6CRuH8bCFomXJHuLxPWff-Xa4ZVk",
      authDomain: "xperts-data.firebaseapp.com",
      projectId: "xperts-data",
      storageBucket: "xperts-data.appspot.com",
      messagingSenderId: "934675149024",
      appId: "1:934675149024:web:23486a5f38f65f103ce085",
      measurementId: "G-6TS06NTDZQ"
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();

    const user = JSON.parse(localStorage.getItem('user'));

    // Protect page
    if (!user || user.role !== 'Student') {
      window.location.href = 'sub003.html';
    }

    async function loadData() {
      try {
        const doc = await db.collection('users').doc(user.id).get();
        if (!doc.exists) {
          document.getElementById('content').innerHTML = "<p>User data not found.</p>";
          return;
        }
        const data = doc.data();
        document.getElementById('content').innerHTML = `
          <p><strong>Name:</strong> ${data.name || 'N/A'}</p>
          <p><strong>Mobile:</strong> ${data.mobileNumber}</p>
          <p><strong>Class:</strong> ${data.class || 'N/A'}</p>
        `;
      } catch (err) {
        document.getElementById('content').innerHTML = "<p>Error loading data.</p>";
      }
    }

    function logout() {
      localStorage.removeItem('user');
      window.location.href = 'sub003.html';
    }

    window.onload = loadData;
  </script>

</body>
</html>
