<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Your Documents</title>
  <style>
    body { margin:0; font-family: Arial, sans-serif; background:#edf2fa; }
    header { background:#fff; padding:15px 20px; box-shadow:0 1px 3px rgba(0,0,0,.1); display:flex; align-items:center; position:sticky; top:0; }
    header h1 { font-size:1.2em; margin:0; }
    .list { padding:20px; }
    .item { background:#fff; padding:15px; margin-bottom:12px; border-radius:10px; display:flex; justify-content:space-between; align-items:center; text-decoration:none; color:#222; box-shadow:0 2px 5px rgba(0,0,0,.05); transition:.2s; }
    .item:hover { transform:translateY(-2px); box-shadow:0 4px 10px rgba(0,0,0,.08); }
    .footer { text-align:center; padding:30px; color:#666; font-size:14px; }
  </style>
</head>
<body>
  <header>
    <h1>Your Documents</h1>
  </header>

  <main class="list" id="doc-list">
    <p style="text-align:center;color:#555;">Loading...</p>
  </main>

  <div class="footer">That's all for now.</div>

  <!-- Firebase -->
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>
  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyD-ers6CRuH8bCFomXJHuLxPWff-Xa4ZVk",
      authDomain: "xperts-data.firebaseapp.com",
      projectId: "xperts-data",
      storageBucket: "xperts-data.firebasestorage.app",
      messagingSenderId: "934675149024",
      appId: "1:934675149024:web:23486a5f38f65f103ce085"
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();

    const docList = document.getElementById('doc-list');
    const userClass = localStorage.getItem('loggedInUserClass');
    const userId = localStorage.getItem('loggedInUserId');

    if (!userId || !userClass) {
      window.location.href = "1.html"; // redirect if not logged in
    }

    async function loadDocs() {
      try {
        const snapshot = await db.collection("documents")
          .where("class","==",userClass)
          .orderBy("createdAt","desc")
          .get();
        docList.innerHTML = '';
        if (snapshot.empty) {
          docList.innerHTML = '<p style="text-align:center;color:#555;">No documents found.</p>';
          return;
        }
        snapshot.forEach(doc => {
          const data = doc.data();
          const a = document.createElement('a');
          a.href = data.url;
          a.target = "_blank";
          a.className = "item";
          a.innerHTML = `<span>${data.title}</span><span>&gt;</span>`;
          docList.appendChild(a);
        });
      } catch (err) {
        console.error(err);
        docList.innerHTML = '<p style="text-align:center;color:#c00;">Failed to load documents.</p>';
      }
    }
    loadDocs();
  </script>
</body>
</html>
